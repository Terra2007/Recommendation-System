# TF-IDF

"옥수수"를 검색합니다. 그럼 검색 결과로 수많은 웹 페이지가 뜹니다. 어떤 문서는 최상단에 위치하고 있지만, 어떤 문서는 10페이지가 넘어가서 있기도 합니다. 우리는 자연스레 최상단에 위치한 문서가 내 검색어와 가장 관련되어 있으며, 이 문서에서 내가 원하는 정보를 찾을 수 있을 것이라 생각합니다. 그러면 어떤 기준으로 관련도를 측정할까요?



> **TF-IDF**(Term Frequency - Inverse Document Frequency)는 **정보 검색**과 **텍스트 마이닝**에서 이용하는 가중치로, 여러 문서로 이루어진 문서군이 있을 때 어떤 단어가 특정 문서 내에서 얼마나 중요한 것인지를 나타내는 **통계**적 수치이다.
>
> 문서의 핵심어를 추출하거나, 검색 엔진에서 검색 결과의 순위를 결정하거나, 문서들 사이의 비슷한 정도를 구하는 등의 용도로 사용할 수 있다.
>
> > 위키백과



TF-IDF는 다음과 같이 표현됩니다.
$$
TF-IDF(t, d, D) = TF(t, d) \times IDF(t, D)
$$
t는 term으로 단어, d는 document로 문서 1개, D는 documnet로 문서 전체를 나타냅니다.



## TF (Term Frequency, 단어 빈도수)

TF(t, d)를 계산하는 방법은 3가지가 있습니다.

1. boolean 빈도
   $$
   TF(t, d) = \begin{pmatrix} 1, d에t가있다면 \\ 0, d에t가없다면 \end{pmatrix}
   $$

2. log-scale 빈도
   $$
   TF(t, d) = log(f(t, d) + 1)
   $$
   f(t, d)란 단순히 d에 t가 나오는 빈도수입니다.

   log-scale 이란 log 함수를 사용해서 결과값의 크기가 너무 커지지 않도록 조절하겠다는 뜻입니다. d에 t가 노골적으로 너무 많이 나오면 tf 값이 지나치게 높아져 제대로 된 TF-IDF 값을 구할 수 없습니다. tf값에 log를 씌워준다면 t가 아주아주아주 많이 나오더라도 tf값은 그게 맞춰 커지지 않고, 적절한 값을 가집니다. 따라서 TF-IDF 값도 적절한 값을 갖게 됩니다.

   log 함수의 약점은 x가 0일 때, y가 마이너스 무한대로 수렴한다는 점입니다. d에 t가 없다고 tf 값이 마이너스 무한대가 된다면, TF-IDF 식은 의미가 없어집니다. 따라서 마이너스 무한대를 방지하기 위해 f(t, d)에 1을 더해 tf의 최소값이 0이 되게 맞춰줍니다. (굳이 1이 아니여도 상관없지만 통상적으로 1을 더해줍니다.)이를 스무딩(Smoothing)이라고 합니다.

3. 증가 빈도
   $$
   TF(t, d) = 0.5 + {0.5 \times f(t, d)\over max\{f(w, d) : w \in d\}}
   $$
   w는 word의 약자로 단어 전체입니다.

   분모는 특정 문서 d에서 모든 단어의 빈도수를 셉니다. 빈도수가 가장 많은 단어의 빈도수가 분모가 됩니다. 문서의 길이가 긴 경우 이 식을 사용한다고 합니다.

   

   이 외에도 좋은 tf값을 얻기 위한 변형식이 무수히 많습니다. 프로젝트의 성격의 따라 고르시면 됩니다.

## IDF (Inversed Document Frequency, 역문서 빈도)

$$
IDF(t, D) = log{\vert D\vert \over \vert \{d\in D:t \in d\}\vert+1} 
$$

분자는 전체 문서의 개수이고, 분모는 t가 들어있는 문서의 개수입니다. 분수에서 분모는 0이 되면 안 되기 때문에 +1로 스무딩 처리를 했습니다. 전체 문서의 개수가 0일 리는 없기 때문에 분자엔 스무딩 기법을 쓰지 않아도 됩니다. 그리고 log 함수를 사용해 log-scale 처리를 해줬습니다.

특정 단어가 모든 문서에서 등장한다면 idf 값은 log1 = 0이 되어(스무딩 처리를 안했다면) 그 단어는 가치가 없는 것으로 판단됩니다. 은/는, 이/가 같은 조사가 대표적인 예입니다.



TF-IDF 값이 높으려면,

TF 관점 : d에 t가 많이 나올수록 좋습니다.

IDF 관점 : t가 나오는 d가 적을수록 좋습니다. (idf 식의 분모가 작아지는 효과입니다.)

즉, 다른 문서에서는 잘 나오지 않는 "옥수수"가 A문서에서 많이 등장한다면, A문서의 핵심어는 "옥수수"입니다. 검색 엔진에 "옥수수"를 검색하면 A문서가 최상단에 위치할 것 입니다.

하지만 실제 검색 엔진에서는 위와 같이 단순한 TF-IDF 식을 쓰지 않고, 여러가지를 붙이고 떼고 더 정밀하게 만든 식을 사용합니다.
